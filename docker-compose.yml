version: '3.5'
services:
  adguard:
    image: adguard/adguardhome:latest
    restart: always
    ports:
      - 53:53 #DNS
      - 67:67 #DHCP Server
      - 8080:80 #webport
      - 3009:3000 #webport
      - 853:853 #DNS over TLS
      - 5443:5443 #DNSCRYPT
    volumes:
      - ./adguard/workdir:/opt/adguardhome/work
      - ./adguard/confdif:/opt/adguardhome/conf
    deploy:
      replicas: 1
  grafana:
    image: grafana/grafana:latest
    restart: always
    ports:
      - 3000:3000
    deploy:
      replicas: 1
  influxdb:
    image: influxdb:1.8.10
    restart: always
    ports:
      - 8086:8086 #expose data on port 8086
      - 25826:25826 #read data from collectd source on port 25826
    volumes:
      - ./influxdbvolume:/var/lib/influxdb2
      - ./docker/influxdb/types.db:/usr/share/collectd/types.db:ro
        #- ./docker/influxdb/influxdb.conf:/etc/influxdb/influxdb.conf
        #influxdb.conf causes a problem with types.db need to understand how to configure influxdb.conf
    deploy:
      replicas: 0
      
